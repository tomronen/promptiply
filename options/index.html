<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>promptiply Settings</title>
  <link rel="icon" type="image/png" href="../icons/icon-48.png" />
  <link rel="stylesheet" href="styles.css" />
  <script defer src="index.js"></script>
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="title title-flex">
        <img src="../icons/icon-48.png" alt="promptiply" class="icon-48" />
        promptiply — Settings
      </div>
      <div style="display:flex; gap:8px; align-items:center;">
        <div class="muted" id="version">-</div>
      </div>
    </div>
    <div class="tabs">
      <div class="tab active" data-tab="general">General</div>
      <div class="tab" data-tab="providers">Providers</div>
      <div class="tab" data-tab="profiles">Profiles</div>
    </div>

    <div class="panel" id="tab-general">
      <div class="grid">
        <div class="field field-no-margin">
          <label>Refinement Mode</label>
          <select id="mode">
            <option value="api">API (OpenAI/Anthropic)</option>
            <option value="webui">WebUI (use provider site)</option>
            <option value="local">Local (Llama 3 via web-llm)</option>
          </select>
        </div>
        <div class="field field-no-margin">
          <label>Provider</label>
          <select id="provider">
            <option value="openai">OpenAI (ChatGPT)</option>
            <option value="anthropic">Anthropic (Claude)</option>
          </select>
        </div>
        <div class="field field-no-margin" style="grid-column:1 / -1;">
          <label>Analytics</label>
          <div style="display:flex; gap:8px; align-items:center;">
            <input id="analytics-optin" type="checkbox" />
            <div class="muted">Help improve promptiply by sending anonymous local events (stored locally). No external network by default.</div>
          </div>
        </div>
      </div>
      <div class="field field-top-margin" id="analytics-debug">
        <label>Analytics (debug)</label>
        <div style="display:flex; gap:8px; align-items:center; margin-bottom:8px;">
          <button id="analytics-view" type="button">View Events</button>
          <button id="analytics-export" type="button">Export JSON</button>
          <button id="analytics-clear" type="button">Clear Events</button>
          <div class="muted" id="analytics-count">0 events</div>
        </div>
        <pre id="analytics-list" style="display:none; max-height:220px; overflow:auto; background:#071022; padding:8px; border-radius:8px; border:1px solid var(--border);"></pre>
      </div>
      <div class="field field-full field-top-margin">
        <label>Refine Hotkey</label>
        <div class="hotkey-row">
          <div id="refine-hotkey-display" class="hotkey-display">
            <span id="refine-hotkey-text">-</span>
          </div>
          <button id="refine-hotkey-record" type="button">Change</button>
        </div>
        <div id="refine-hotkey-recording" class="hotkey-hint">
          Press your desired key combination... (Press Escape to cancel)
        </div>
      </div>
      <div class="actions actions-top-margin">
        <button id="save-settings" class="primary">Save Settings</button>
        <button id="run-onboarding" class="secondary">Run Onboarding Wizard</button>
      </div>
    </div>

    <div class="panel tab-panel-hidden" id="tab-providers">
      <div class="grid">
        <div>
          <div class="field"><label>OpenAI API Key</label><input id="openai-key" type="password" placeholder="OpenAI API Key" /></div>
          <div class="field field-no-margin"><label>OpenAI Model</label>
            <select id="openai-model-select">
              <option value="gpt-5-nano">gpt-5-nano</option>
              <option value="gpt-5-mini">gpt-5-mini</option>
              <option value="gpt-5">gpt-5</option>
              <option value="custom">Custom…</option>
            </select>
            <input id="openai-model-custom" type="text" placeholder="Custom model id" class="custom-input-hidden" />
          </div>
        </div>
        <div>
          <div class="field"><label>Anthropic API Key</label><input id="anthropic-key" type="password" placeholder="Anthropic API Key" /></div>
          <div class="field field-no-margin"><label>Anthropic Model</label>
            <select id="anthropic-model-select">
              <option value="claude-haiku-4-5">Claude Haiku 4.5</option>
              <option value="claude-sonnet-4-5">Claude Sonnet 4.5</option>
              <option value="custom">Custom…</option>
            </select>
            <input id="anthropic-model-custom" type="text" placeholder="Custom model id" class="custom-input-hidden" />
          </div>
        </div>
      </div>
      <div class="actions actions-top-margin">
        <button id="save-providers-settings" class="primary">Save Settings</button>
      </div>
    </div>

    <div class="panel tab-panel-hidden" id="tab-profiles">
      <div class="actions actions-flex-end">
        <button id="new-profile" class="primary">New Profile</button>
      </div>
      <div id="profiles-list" class="list"></div>
    </div>

    <p class="muted muted-top-margin">Your API keys are stored locally on this device. Profiles sync across Chrome if enabled.</p>
    
    <!-- Profile Wizard Modal (used by New Profile / Create Profile) -->
    <div class="modal" id="profile-modal">
      <div class="dialog">
        <div class="title-flex">
          <img src="../icons/icon-48.png" alt="promptiply" class="icon-48" />
          <div style="font-weight:700;">Profile Wizard</div>
        </div>
        <div class="progress-wrap"><div class="wizard-progress" id="wizard-progress"></div></div>
        <div class="steps">
          <div class="step" data-step="1">Basics</div>
          <div class="step" data-step="2">Guidelines</div>
          <div class="step" data-step="3">Review</div>
        </div>
        <div id="wizard-body"></div>
        <div class="actions actions-space-between actions-top-margin">
          <div>
            <button id="wizard-cancel">Cancel</button>
          </div>
          <div>
            <button id="wizard-back">Back</button>
            <button id="wizard-next" class="primary">Next</button>
            <button id="wizard-save" class="primary wizard-save-hidden">Save</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Onboarding Wizard Modal (rich) -->
    <div class="modal" id="onboarding-modal">
      <div class="dialog onboarding-dialog">
        <div class="onboarding-header">
          <img src="../icons/icon-48.png" alt="promptiply" class="icon-48" />
          <h2>Welcome to promptiply!</h2>
        </div>
        <div class="steps">
          <div class="step" data-step="1">Modes</div>
          <div class="step" data-step="2">Setup</div>
          <div class="step" data-step="3">Profile</div>
          <div class="step" data-step="4">Ready</div>
        </div>
        <div id="onboarding-body"></div>
        <div class="actions actions-space-between actions-top-margin">
          <div>
            <button id="onboarding-skip">Skip</button>
          </div>
          <div>
            <button id="onboarding-back">Back</button>
            <button id="onboarding-next" class="primary">Next</button>
            <button id="onboarding-finish" class="primary wizard-save-hidden">Get Started</button>
          </div>
        </div>
      </div>
    </div>
</body>
</html>




